"use strict";(self["webpackChunkroommate_match_vue"]=self["webpackChunkroommate_match_vue"]||[]).push([[90],{5090:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});r(7658);var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"background-login",staticStyle:{height:"100vh",display:"flex","align-items":"center","justify-content":"center","background-color":"#8ac0f2"}},[e._m(0),t("div",{staticStyle:{display:"flex","background-color":"white",opacity:"0.85",width:"50%","border-radius":"30px",overflow:"hidden"}},[e._m(1),t("div",{staticStyle:{flex:"1",display:"flex","align-items":"center","justify-content":"center"}},[t("el-form",{ref:"loginRef",staticStyle:{width:"80%"},attrs:{model:e.user,rules:e.rules}},[t("div",{staticStyle:{"font-size":"20px","font-weight":"bold","text-align":"center","margin-bottom":"20px"}},[e._v("欢迎登录后台管理系统")]),t("el-form-item",{attrs:{prop:"number"}},[t("el-input",{attrs:{"prefix-icon":"el-icon-user",size:"medium",placeholder:"请输入学号"},model:{value:e.user.number,callback:function(t){e.$set(e.user,"number",t)},expression:"user.number"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{"prefix-icon":"el-icon-lock",size:"medium","show-password":"",placeholder:"请输入密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),t("el-form-item",{attrs:{prop:"code"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input",{staticStyle:{flex:"1"},attrs:{placeholder:"请输入验证码","prefix-icon":"el-icon-circle-check",size:"medium"},model:{value:e.user.code,callback:function(t){e.$set(e.user,"code",t)},expression:"user.code"}}),t("div",{staticStyle:{flex:"1",height:"36px"}},[t("valid-code",{on:{"update:value":e.getCode}})],1)],1)]),t("el-form-item",[t("el-button",{ref:"loginBtn",staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.login}},[e._v("登 录")])],1),t("div",{staticStyle:{display:"flex"}},[t("div",{staticStyle:{flex:"1"}},[e._v("还没有账号？请 "),t("span",{staticStyle:{color:"#0f9876",cursor:"pointer"},on:{click:function(t){return e.$router.push("/register")}}},[e._v("注册")])]),t("div",{staticStyle:{flex:"1","text-align":"right"}},[t("span",{staticStyle:{color:"#0f9876",cursor:"pointer"},on:{click:function(t){return e.$router.push("/forget")}}},[e._v("忘记密码")])])])],1)],1)])])},s=[function(){var e=this,t=e._self._c;return t("div",{staticStyle:{position:"absolute",top:"10px",left:"10px"}},[t("img",{staticStyle:{width:"20%"},attrs:{src:r(2330),alt:""}})])},function(){var e=this,t=e._self._c;return t("div",{staticStyle:{flex:"1"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:r(9520),alt:""}})])}],i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ValidCode disabled-select",staticStyle:{width:"100%",height:"100%"},on:{click:e.refreshCode}},e._l(e.codeList,(function(r,o){return t("span",{key:o,style:e.getStyle(r)},[e._v(e._s(r.code))])})),0)},a=[],n={name:"validCode",data(){return{length:4,codeList:[]}},mounted(){this.createdCode()},methods:{refreshCode(){this.createdCode()},createdCode(){let e=this.length,t=[],r="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz0123456789",o=r.length;for(let s=0;s<e;s++){let e=[Math.round(220*Math.random()),Math.round(240*Math.random()),Math.round(200*Math.random())];t.push({code:r.charAt(Math.floor(Math.random()*o)),color:`rgb(${e})`,padding:`${[Math.floor(10*Math.random())]}px`,transform:`rotate(${Math.floor(90*Math.random())-Math.floor(90*Math.random())}deg)`})}this.codeList=t,this.$emit("update:value",t.map((e=>e.code)).join(""))},getStyle(e){return`color: ${e.color}; font-size: ${e.fontSize}; padding: ${e.padding}; transform: ${e.transform}`}}},l=n,c=r(1001),d=(0,c.Z)(l,i,a,!1,null,null,null),u=d.exports,h={name:"LoginView",components:{ValidCode:u},data(){const e=(e,t,r)=>{""===t?r(new Error("请输入验证码")):t.toLowerCase()!==this.code?r(new Error("验证码错误")):r()};return{code:"",user:{code:"",number:"",password:""},rules:{number:[{required:!0,message:"请输入学号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{validator:e,trigger:"blur"}]}}},created(){},mounted(){document.addEventListener("keydown",this.handleKeyDown)},destroyed(){document.removeEventListener("keydown",this.handleKeyDown)},methods:{getCode(e){this.code=e.toLowerCase()},login(){this.$refs["loginRef"].validate((e=>{e&&this.$request.post("/user/login",this.user).then((e=>{1===e.code?(this.$router.push("/"),this.$message.success("登录成功"),localStorage.setItem("ecut-user",JSON.stringify(e.data))):this.$message.error(e.msg)}))}))},handleKeyDown(e){13===e.keyCode&&this.$refs.loginBtn.$el.click()},validateNumber:(e,t,r)=>{const o=(new Date).getFullYear();/^\d{10}$/.test(t)?t.substr(0,4)<1956||t.substr(0,4)>o?r(new Error("学号格式有误")):r():r(new Error("学号格式有误"))}}},m=h,f=(0,c.Z)(m,o,s,!1,null,"3124ec51",null),p=f.exports},9520:function(e,t,r){e.exports=r.p+"img/login.a3c3ecaa.png"},2330:function(e,t,r){e.exports=r.p+"img/school.a85773f8.png"}}]);
//# sourceMappingURL=90.9b73db45.js.map
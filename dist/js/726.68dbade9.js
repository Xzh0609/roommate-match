"use strict";(self["webpackChunkroommate_match_vue"]=self["webpackChunkroommate_match_vue"]||[]).push([[726],{1726:function(e,t,r){r.r(t),r.d(t,{default:function(){return n}});var a=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticStyle:{width:"50%"}},[t("el-form",{ref:"personRef",staticStyle:{"padding-right":"20px"},attrs:{model:e.form,"label-width":"80px",rules:e.rules}},[t("el-form-item",{attrs:{label:"学号",prop:"number"}},[t("el-input",{attrs:{placeholder:"请输入学号",clearable:""},on:{input:e.handleNumberInput},model:{value:e.form.number,callback:function(t){e.$set(e.form,"number",t)},expression:"form.number"}})],1),t("el-form-item",{attrs:{label:"姓名",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入姓名",clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"性别",prop:"gender"}},[t("el-radio-group",{model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[t("el-radio",{attrs:{label:"1"}},[e._v("男")]),t("el-radio",{attrs:{label:"0"}},[e._v("女")])],1)],1),t("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[t("el-input",{attrs:{placeholder:"请输入手机号",clearable:""},on:{input:e.handlePhoneInput},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("el-form-item",{attrs:{label:"qq",prop:"qq"}},[t("el-input",{directives:[{name:"debounce",rawName:"v-debounce:5000",value:e.validateQQ,expression:"validateQQ",arg:"5000"}],attrs:{placeholder:"请输入qq",clearable:""},model:{value:e.form.qq,callback:function(t){e.$set(e.form,"qq",t)},expression:"form.qq"}})],1),t("el-form-item",{attrs:{label:"专业",prop:"major"}},[t("el-input",{attrs:{placeholder:"请输入专业",clearable:""},model:{value:e.form.major,callback:function(t){e.$set(e.form,"major",t)},expression:"form.major"}})],1),t("el-form-item",{attrs:{label:"抽烟",prop:"smoke"}},[t("el-radio-group",{model:{value:e.form.smoke,callback:function(t){e.$set(e.form,"smoke",t)},expression:"form.smoke"}},[t("el-radio",{attrs:{label:"0"}},[e._v("是")]),t("el-radio",{attrs:{label:"1"}},[e._v("否")]),t("el-radio",{attrs:{label:"2"}},[e._v("偶尔")])],1)],1),t("el-form-item",{attrs:{label:"睡觉时间"}},[t("el-time-picker",{staticStyle:{margin:"5px"},attrs:{placeholder:"最早时间","value-format":"HH:mm:ss","picker-options":{selectableRange:"19:00:00 - 23:59:59"}},model:{value:e.form.sleepBeginTime,callback:function(t){e.$set(e.form,"sleepBeginTime",t)},expression:"form.sleepBeginTime"}}),t("span",[e._v("-")]),t("el-time-picker",{staticStyle:{margin:"5px"},attrs:{placeholder:"最晚时间","value-format":"HH:mm:ss","picker-options":{selectableRange:["00:00:00 - 02:59:59","19:00:00 - 23:59:59"]}},model:{value:e.form.sleepEndTime,callback:function(t){e.$set(e.form,"sleepEndTime",t)},expression:"form.sleepEndTime"}})],1),t("el-form-item",{attrs:{label:"起床时间"}},[t("el-time-picker",{staticStyle:{margin:"5px"},attrs:{placeholder:"最早时间","value-format":"HH:mm:ss","picker-options":{selectableRange:"05:00:00 - 11:59:59"}},model:{value:e.form.getUpBeginTime,callback:function(t){e.$set(e.form,"getUpBeginTime",t)},expression:"form.getUpBeginTime"}}),t("span",[e._v("-")]),t("el-time-picker",{staticStyle:{margin:"5px"},attrs:{placeholder:"最晚时间","value-format":"HH:mm:ss","picker-options":{selectableRange:"04:59:59 - 11:59:59"}},model:{value:e.form.getUpEndTime,callback:function(t){e.$set(e.form,"getUpEndTime",t)},expression:"form.getUpEndTime"}})],1),t("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入备注(最多200字)",clearable:"",maxlength:200,rows:"4"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),t("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"}},[t("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",disabled:e.isNumberEmpty||e.isPhoneEmpty},on:{click:e.handleClick}},[e._v("保 存")])],1)],1)],1)],1)},l=[],s={beforeRouteLeave(e,t,r){this.$confirm("未保存的结果将消失哦，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{r()})).catch((()=>{this.$message({type:"success",message:"已取消跳转"})}))},name:"PersonView",data(){return{user:JSON.parse(localStorage.getItem("ecut-user")||"{}"),fromVisible:!1,form:{},rules:{number:[{required:!0,message:"请输入学号",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:this.validatePhone,trigger:"blur"}],qq:[{validator:this.validateQQ,trigger:"blur"}]}}},computed:{isNumberEmpty(){return""===this.form.number},isPhoneEmpty(){return""===this.form.phone}},created(){window.addEventListener("beforeunload",this.handleBeforeUnload)},mounted(){this.$request.get("/user").then((e=>{this.form=e.data}))},methods:{handleBeforeUnload(e){var t="确定重新加载此页面吗？";return e.returnValue=t,t},checkSecondsTime(){let e=this.form.getUpBeginTime,t=this.form.getUpEndTime,r=this.form.sleepBeginTime,a=this.form.sleepEndTime,l=e.split(":"),s=t.split(":"),o=r.split(":"),i=a.split(":"),m=parseInt(l[2]),n=parseInt(s[2]),p=parseInt(o[2]),c=parseInt(i[2]);0==m&&0==n&&0==p&&0==c||this.$notify({title:"细啊！",message:"竟然精确到秒",type:"success"})},handleClick(){this.update(),this.checkSecondsTime()},update(){this.$refs["personRef"].validate((e=>{e&&this.$request.put("/user",this.form).then((e=>{if(1===e.code){this.$message.success("保存成功");const e=JSON.parse(localStorage.getItem("ecut-user"));e.number=this.form.number,localStorage.setItem("ecut-user",JSON.stringify(e))}else this.$message.error(e.msg)}))}))},handleNumberInput(){this.isNumberEmpty=""===this.form.number},handlePhoneInput(){this.isPhoneEmpty=""===this.form.phone},validatePhone(e,t,r){const a=/^1[0-9]{10}$/;a.test(t)?r():r(new Error("请输入正确的手机号"))},validateNumber:(e,t,r)=>{const a=(new Date).getFullYear();/^\d{10}$/.test(t)?t.substr(0,4)<1956||t.substr(0,4)>a?r(new Error("学号格式有误")):r():r(new Error("学号格式有误"))},validateQQ(e,t,r){null==t&&r();const a=/^(?:[1-9][0-9]{4,14})?$/;a.test(t)?r():r(new Error("请输入正确的QQ号"))}}},o=s,i=r(1001),m=(0,i.Z)(o,a,l,!1,null,"9c317bba",null),n=m.exports}}]);
//# sourceMappingURL=726.68dbade9.js.map
"use strict";(self["webpackChunkroommate_match_vue"]=self["webpackChunkroommate_match_vue"]||[]).push([[376],{8376:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var l=function(){var e=this,t=e._self._c;return t("div",[t("div",[t("el-input",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{placeholder:"查询学号"},model:{value:e.number,callback:function(t){e.number=t},expression:"number"}}),t("el-input",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{placeholder:"查询姓名"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),t("el-input",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{placeholder:"查询性别"},on:{change:e.handleGenderChange},model:{value:e.genderText,callback:function(t){e.genderText=t},expression:"genderText"}}),t("el-input",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{placeholder:"查询qq"},model:{value:e.qq,callback:function(t){e.qq=t},expression:"qq"}}),t("el-input",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{placeholder:"查询专业"},model:{value:e.major,callback:function(t){e.major=t},expression:"major"}}),t("el-input",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{placeholder:"查询备注"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}}),t("el-input",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{placeholder:"查询是否抽烟"},on:{change:e.handleSmokeChange},model:{value:e.smokeText,callback:function(t){e.smokeText=t},expression:"smokeText"}}),t("el-time-picker",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{placeholder:"睡觉最早时间","value-format":"HH:mm:ss","picker-options":{selectableRange:"19:00:00 - 23:59:59"}},model:{value:e.sleepBeginTime,callback:function(t){e.sleepBeginTime=t},expression:"sleepBeginTime"}}),t("el-time-picker",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{placeholder:"睡觉最晚时间","value-format":"HH:mm:ss","picker-options":{selectableRange:["00:00:00 - 02:59:59","19:00:00 - 23:59:59"]}},model:{value:e.sleepEndTime,callback:function(t){e.sleepEndTime=t},expression:"sleepEndTime"}}),t("el-time-picker",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{placeholder:"起床最早时间","value-format":"HH:mm:ss","picker-options":{selectableRange:"05:00:00 - 11:59:59"}},model:{value:e.getUpBeginTime,callback:function(t){e.getUpBeginTime=t},expression:"getUpBeginTime"}}),t("el-time-picker",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{placeholder:"起床最晚时间","value-format":"HH:mm:ss","picker-options":{selectableRange:"04:59:59 - 11:59:59"}},model:{value:e.getUpEndTime,callback:function(t){e.getUpEndTime=t},expression:"getUpEndTime"}}),t("br"),t("el-button",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{type:"primary"},on:{click:function(t){return e.load(1)}}},[e._v("查询")]),t("el-button",{staticStyle:{width:"150px",margin:"3px 5px"},attrs:{type:"info"},on:{click:e.reset}},[e._v("重置")])],1),t("div",{staticStyle:{margin:"10px 0"}}),t("el-table",{attrs:{data:e.tableData,stripe:"","header-cell-style":{backgroundColor:"aliceblue",color:"#666"}},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{prop:"number",align:"center",label:"学号",width:"100",fixed:""}}),t("el-table-column",{attrs:{prop:"name",align:"center",label:"姓名",width:"180"}}),t("el-table-column",{attrs:{prop:"gender",align:"center",label:"性别",width:"180"},scopedSlots:e._u([{key:"default",fn:function(r){return["1"==r.row.gender?t("div",[e._v("男")]):e._e(),"0"==r.row.gender?t("div",[e._v("女")]):t("div")]}}])}),t("el-table-column",{attrs:{prop:"qq",align:"center",label:"qq",width:"180"}}),t("el-table-column",{attrs:{prop:"major",align:"center",label:"专业",width:"180"}}),t("el-table-column",{attrs:{prop:"smoke",align:"center",label:"是否抽烟",width:"180"},scopedSlots:e._u([{key:"default",fn:function(r){return["0"==r.row.smoke?t("div",[e._v("是")]):e._e(),"1"==r.row.smoke?t("div",[e._v("否")]):e._e(),"2"==r.row.smoke?t("div",[e._v("偶尔")]):t("div")]}}])}),t("el-table-column",{attrs:{prop:"sleepBeginTime",align:"center",label:"睡觉最早时间",width:"180"}}),t("el-table-column",{attrs:{prop:"sleepEndTime",align:"center",label:"睡觉最晚时间",width:"180"}}),t("el-table-column",{attrs:{prop:"getUpBeginTime",align:"center",label:"起床最早时间",width:"180"}}),t("el-table-column",{attrs:{prop:"getUpEndTime",align:"center",label:"起床最晚时间",width:"180"}}),t("el-table-column",{attrs:{prop:"remarks",align:"center",label:"备注",width:"180","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(r){return[null!==r.row.remarks?t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.showRemarks(r.row)}}},[e._v("点我查看备注")]):t("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(t){return e.showRemarks(r.row)}}},[e._v("该同学暂未填写备注")])]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(r){return[e.isCurrentUser(r.row.number)?t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleEdit(r.row)}}},[e._v("编辑")]):e._e(),e.isCurrentUser(r.row.number)?t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(r.row.id)}}},[e._v("删除")]):e._e()]}}])})],1),t("div",[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[2,3,4,5,10,20,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:this.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:"用户信息",visible:e.fromVisible,width:"45%","close-on-click-modal":!1},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"20px"},attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"学号",prop:"number"}},[t("el-input",{attrs:{placeholder:"请输入学号",clearable:""},on:{input:e.handleNumberInput},model:{value:e.form.number,callback:function(t){e.$set(e.form,"number",t)},expression:"form.number"}})],1),t("el-form-item",{attrs:{label:"姓名",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入姓名",clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"性别",prop:"gender"}},[t("el-radio-group",{model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[t("el-radio",{attrs:{label:"1"}},[e._v("男")]),t("el-radio",{attrs:{label:"0"}},[e._v("女")])],1)],1),t("el-form-item",{attrs:{label:"qq",prop:"qq"}},[t("el-input",{attrs:{placeholder:"qq",clearable:""},model:{value:e.form.qq,callback:function(t){e.$set(e.form,"qq",t)},expression:"form.qq"}})],1),t("el-form-item",{attrs:{label:"专业",prop:"major"}},[t("el-input",{attrs:{placeholder:"请输入专业",clearable:""},model:{value:e.form.major,callback:function(t){e.$set(e.form,"major",t)},expression:"form.major"}})],1),t("el-form-item",{attrs:{label:"抽烟",prop:"smoke"}},[t("el-radio-group",{model:{value:e.form.smoke,callback:function(t){e.$set(e.form,"smoke",t)},expression:"form.smoke"}},[t("el-radio",{attrs:{label:"0"}},[e._v("是")]),t("el-radio",{attrs:{label:"1"}},[e._v("否")]),t("el-radio",{attrs:{label:"2"}},[e._v("偶尔")])],1)],1),t("el-form-item",{attrs:{label:"睡觉时间"}},[t("el-time-picker",{staticStyle:{margin:"5px"},attrs:{placeholder:"最早时间","value-format":"HH:mm:ss","picker-options":{selectableRange:"19:00:00 - 23:59:59"}},model:{value:e.form.sleepBeginTime,callback:function(t){e.$set(e.form,"sleepBeginTime",t)},expression:"form.sleepBeginTime"}}),t("span",[e._v("-")]),t("el-time-picker",{staticStyle:{margin:"5px"},attrs:{placeholder:"最晚时间","value-format":"HH:mm:ss","picker-options":{selectableRange:["00:00:00 - 02:59:59","19:00:00 - 23:59:59"]}},model:{value:e.form.sleepEndTime,callback:function(t){e.$set(e.form,"sleepEndTime",t)},expression:"form.sleepEndTime"}})],1),t("el-form-item",{attrs:{label:"起床时间"}},[t("el-time-picker",{staticStyle:{margin:"5px"},attrs:{placeholder:"最早时间","value-format":"HH:mm:ss","picker-options":{selectableRange:"05:00:00 - 11:59:59"}},model:{value:e.form.getUpBeginTime,callback:function(t){e.$set(e.form,"getUpBeginTime",t)},expression:"form.getUpBeginTime"}}),t("span",[e._v("-")]),t("el-time-picker",{staticStyle:{margin:"5px"},attrs:{placeholder:"最晚时间","value-format":"HH:mm:ss","picker-options":{selectableRange:"04:59:59 - 11:59:59"}},model:{value:e.form.getUpEndTime,callback:function(t){e.$set(e.form,"getUpEndTime",t)},expression:"form.getUpEndTime"}})],1),t("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入备注(最多200字)",clearable:"",maxlength:200},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",disabled:e.isNumberEmpty},on:{click:e.handleSecondsClick}},[e._v("确 定")])],1)],1)],1)},a=[],i=(r(7658),{name:"UserView",data(){return{tableData:[],page:1,pageSize:5,number:"",numberId:JSON.parse(localStorage.getItem("ecut-user")||"{}").number,name:"",gender:"",qq:"",major:"",remarks:"",smoke:"",sleepBeginTime:"",sleepEndTime:"",getUpBeginTime:"",getUpEndTime:"",genderText:"",smokeText:"",total:0,fromVisible:!1,form:{},rules:{number:[{required:!0,message:"请输入学号",trigger:"blur"}],qq:[{validator:this.validateQQ,trigger:"blur"}]}}},computed:{isNumberEmpty(){return""===this.form.number}},created(){this.load()},mounted(){document.addEventListener("click",this.handleClick)},beforeDestroy(){document.removeEventListener("click",this.handleClick)},methods:{handleSecondsClick(){this.save(),this.checkSecondsTime()},checkSecondsTime(){let e=this.form.getUpBeginTime,t=this.form.getUpEndTime,r=this.form.sleepBeginTime,l=this.form.sleepEndTime,a=e.split(":"),i=t.split(":"),s=r.split(":"),n=l.split(":"),o=parseInt(a[2]),m=parseInt(i[2]),p=parseInt(s[2]),c=parseInt(n[2]);0==o&&0==m&&0==p&&0==c||this.$notify({title:"细啊！",message:"竟然精确到秒",type:"success"})},del(e){this.$confirm("您确认删除吗？删除后将自动退出登录。","确认删除",{type:"warning"}).then((()=>{this.$request.delete("/messages/"+e).then((e=>{1===e.code?(this.$message.success("操作成功"),this.$router.push("/login")):this.$message.error(e.msg)}))})).catch((()=>{}))},handleEdit(e){this.form=JSON.parse(JSON.stringify(e)),this.fromVisible=!0},showRemarks(e){let t=e.name||"无名大侠",r=e.remarks||"该同学暂未填写备注";this.$alert(r,t+"的备注",{confirmButtonText:"确定"})},save(){this.$refs.formRef.validate((e=>{e&&this.$request({url:(this.form.id,"/messages"),method:this.form.id?"PUT":"POST",data:this.form}).then((e=>{if(1===e.code){this.$message.success("保存成功");const e=JSON.parse(localStorage.getItem("ecut-user"));e.number=this.form.number,localStorage.setItem("ecut-user",JSON.stringify(e)),this.load(1),this.fromVisible=!1}else this.$message.error(e.msg)}))}))},reset(){this.name="",this.number="",this.gender="",this.genderText="",this.qq="",this.major="",this.smoke="",this.smokeText="",this.sleepBeginTime="",this.sleepEndTime="",this.getUpBeginTime="",this.getUpEndTime="",this.remarks="",this.load()},load(e){e&&(this.page=e);const t={page:this.page,pageSize:this.pageSize,number:this.number,name:this.name,gender:this.gender,numberId:this.numberId,qq:this.qq,major:this.major,remarks:this.remarks,smoke:this.smoke,sleepBeginTime:this.sleepBeginTime,sleepEndTime:this.sleepEndTime,getUpBeginTime:this.getUpBeginTime,getUpEndTime:this.getUpEndTime};this.$request.get("/messages",{params:t}).then((e=>{this.tableData=e.data.records,this.total=e.data.total})).catch((e=>{console.error("请求错误:",e)}))},handleCurrentChange(e){this.load(e)},handleGenderChange(){"男"===this.genderText?this.gender="1":"女"===this.genderText?this.gender="0":"1"===this.genderText||"0"===this.genderText?this.gender="2":this.gender=this.genderText},handleSmokeChange(){"是"===this.smokeText?this.smoke="0":"否"===this.smokeText?this.smoke="1":"偶尔"===this.smokeText?this.smoke="2":"2"===this.smokeText||"1"===this.smokeText||"0"===this.smokeText?this.smoke="3":this.smoke=this.smokeText},handleSizeChange(e){this.pageSize=e,this.load(this.page)},isCurrentUser(e){const t=JSON.parse(localStorage.getItem("ecut-user")||"{}");return!(!t||t.number!==e)},handleNumberInput(){this.isNumberEmpty=""===this.form.number},validateNumber:(e,t,r)=>{const l=(new Date).getFullYear();/^\d{10}$/.test(t)?t.substr(0,4)<1956||t.substr(0,4)>l?r(new Error("学号格式有误")):r():r(new Error("学号格式有误"))},validateQQ(e,t,r){null==t&&r();const l=/^(?:[1-9][0-9]{4,14})?$/;l.test(t)?r():r(new Error("请输入正确的QQ号"))}}}),s=i,n=r(1001),o=(0,n.Z)(s,l,a,!1,null,"35f45b32",null),m=o.exports}}]);
//# sourceMappingURL=376.7fe9de33.js.map